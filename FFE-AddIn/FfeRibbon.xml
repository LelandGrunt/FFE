<!--<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui" loadImage="LoadImage">-->
<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" loadImage="LoadImage">
  <ribbon startFromScratch="false">
    <tabs>
      <tab id="tabFfe"
           label="FFE"
           keytip="Q">
        <group id="grpAvq"
               label="AVQ">
          <button id="btnAvqSetAvApiKey"
                  label="Set API Key"
                  size="large"
                  screentip="Set API Key"
                  supertip="Set Alpha Vantage API Key."
                  imageMso="AdpPrimaryKey"
                  onAction="SetAvApiKey"
                  keytip="K" />
          <separator id="sepAvq1" />
          <dropDown id="ddcAvqBatchQueryMode"
                    label="Mode:"
                    supertip="Selection/Range(s) must contain even number of columns."
                    getSelectedItemID="SetStringDefault"
                    onAction="SetBatchQueryMode"
                    keytip="QM"
                    tag="DefaultValue:=ddcAvqBatchQueryModeItemContiguousRange">
            <item id="ddcAvqBatchQueryModeItemContiguousRange"
                  label="Contiguous Range"
                  screentip="Contiguous Selection(s)/Range(s)"
                  supertip="Contiguous Selection(s)/Range(s) with two columns." />
            <item id="ddcAvqBatchQueryModeItemNonContiguousRange"
                  label="Non-Contiguous Range"
                  screentip="Non-Contiguous Selection(s)/Range(s)"
                  supertip="Non-Contiguous Selection/Range(s) with even number of columns." />
            <item id="ddcAvqBatchQueryModeItemNamedRange"
                  label="Named Range"
                  screentip="Named Range(s)"
                  supertip="Named Range(s) with even number of columns." />
          </dropDown>
          <editBox id="ebxAvqRangeName"
                   label="Name:"
                   screentip="Range Name"
                   supertip="Use asterisk (*) at the end as a wildcard search for multiple named ranges."
                   enabled="true"
                   getText="SetStringDefault"
                   onChange="SetBatchQueryNamedRange"
                   keytip="RN"
                   tag="DefaultValue:=*" />
          <checkBox id="cbxAvqBatchComment"
                    label="Batch Comment"
                    screentip="Add refreshment information to cell comment"
                    supertip="If checked, then quote timestamp and the provider is added to the cell comment."
                    getPressed="SetBoolDefault"
                    getVisible="SetVisible"
                    onAction="SetBatchComment" />
          <button id="btnAvqBatchQuery"
                  label="Batch Query"
                  size="large"
                  screentip="Batch Query"
                  supertip="Query stock prices for the selection in a batch. Settings to the left determines used selection/ranges."
                  imageMso="SyncTool"
                  onAction="QueryAlphaVantageAsBatch"
                  keytip="QB" />
          <separator id="sepAvq2" />
          <button id="btnAvqRefreshAvCallLimitReached"
                  label="Refresh #AV-Errors"
                  size="large"
                  screentip="Refresh #AV_CALL_LIMIT_REACHED"
                  supertip="Recalculates all AVQ-UDFs with error #AV_CALL_LIMIT_REACHED in all sheets."
                  imageMso="BlogCategoriesRefresh"
                  onAction="RecalculateAvqCallLimitReachedError" />
          <separator id="sepAvq3" />
          <menu id="mnuAvqHelp"
                label="Help"
                size="large"
                itemSize="normal"
                screentip="AVQ Help"
                supertip="Help links."
                imageMso="Help"
                keytip="AH" >
            <button id="btnAlphaVantageHomepage"
                    label="Alpha Vantage: Homepage"
                    image="AlphaVantageFavicon"
                    onAction="OpenHelpLink"
                    tag="https://www.alphavantage.co" />
            <button id="btnAlphaVantageTermOfServices"
                    label="Alpha Vantage: Term of Services"
                    image="AlphaVantageFavicon"
                    onAction="OpenHelpLink"
                    tag="https://www.alphavantage.co/terms_of_service/" />
            <button id="btnAlphaVantageGetFreeApiKey"
                    label="Alpha Vantage: Get Free API Key"
                    image="AlphaVantageFavicon"
                    onAction="OpenHelpLink"
                    tag="https://www.alphavantage.co/support/#api-key" />
          </menu>
        </group>
        <group id="grpFfe"
               label="FFE">
          <!--autoScale="false">-->
          <button id="btnRefreshAll"
                  label="Refresh All"
                  size="large"
                  screentip="Refresh All"
                  supertip="Recalculates all FFE UDFs in all sheets."
                  imageMso="DataRefreshAll"
                  onAction="RefreshAll"
                  keytip="RA" />
          <button id="btnRefreshSheet"
                  label="Refresh Sheet"
                  size="large"
                  screentip="Refresh Sheet"
                  supertip="Recalculates all FFE UDFs in active sheet."
                  imageMso="BlogCategoriesRefresh"
                  onAction="RefreshSheet"
                  keytip="RW" />
          <button id="btnRefreshSelection"
                  label="Refresh Selection"
                  size="large"
                  screentip="Refresh Selection"
                  supertip="Recalculates all FFE UDFs in current selection."
                  imageMso="BlogCategoriesRefresh"
                  onAction="RefreshSelection"
                  keytip="RS" />
          <separator id="sepFfeAdmin"/>
          <button id="btnViewLog"
                  label="View Log"
                  size="large"
                  screentip="View Log"
                  supertip="View FFE and Excel-DNA log entries."
                  imageMso="FileDocumentInspect"
                  onAction="ViewLog"
                  keytip="VL" />
          <button id="btnReRegisterFunctions"
                  label="(Re-)Register Functions"
                  size="large"
                  screentip="(Re-)Register FFE Functions"
                  imageMso="Repeat"
                  getVisible="SetVisible"
                  onAction="ReRegisterFunctions"
                  tag="ExtendedView:=true" />
          <separator id="sepFfeLogOptions" />
          <menu id="mnuFfeOptions"
                label="Options"
                size="large"
                itemSize="normal"
                screentip="FFE Options"
                supertip="FFE Options."
                imageMso="ColumnContentTypeSetting" >
            <toggleButton id="tgbExtendedView"
                          label="Extended View"
                          screentip="Enable/Disable Extended View"
                          supertip="Show extended options (becomes active after Excel restart)."
                          getPressed="SetBoolDefault"
                          onAction="SetExtendedView" />
            <toggleButton id="tgbRegisterFunctionsOnStartup"
                          label="Register UDFs on Startup"
                          screentip="Enable/Disable automatic registration of FFE user-defined functions"
                          supertip="Register FFE user-defined functions during run-time via '(Re-)Register Functions' (Extended View)."
                          getPressed="SetBoolDefault"
                          onAction="SetRegisterFunctionsOnStartup" />
            <toggleButton id="tgbSsqAutoUpdate"
                          label="SSQ Auto Update"
                          screentip="Enable/Disable automatic update of SSQ definitions"
                          supertip="The update may contain new FFE UDFs and/or update existing ones."
                          getPressed="SetBoolDefault"
                          onAction="SetSsqAutoUpdate" />
            <toggleButton id="tgbCheckUpdateOnStartup"
                          label="Check Update on Startup"
                          screentip="Enable/Disable automatic update check on Excel startup"
                          supertip="Updates may contain new FFE UDFs and/or update existing ones."
                          getPressed="SetBoolDefault"
                          onAction="SetCheckUpdateOnStartup" />
          </menu>
          <checkBox id="cbxFfeLogging"
                    label="Logging"
                    screentip="Enable/Disable Logging"
                    supertip="Log events to Log Viewer and to log files (if enabled)."
                    getPressed="SetBoolDefault"
                    getVisible="SetVisible"
                    onAction="SetFfeLogging"
                    tag="ExtendedView:=true"/>
          <checkBox id="cbxFfeFileLogging"
                    label="File Logging"
                    screentip="Enable/Disable File Logging"
                    supertip="Log events to log files (Logging must be enabled)."
                    getPressed="SetBoolDefault"
                    getVisible="SetVisible"
                    onAction="SetFfeFileLogging"
                    tag="ExtendedView:=true" />
          <dropDown id="ddcFfeLogLevel"
                    label="Log Level"
                    supertip="Set level of events to log."
                    getSelectedItemID="SetStringDefault"
                    getVisible="SetVisible"
                    onAction="SetFfeLogLevel"
                    tag="ExtendedView:=true">
            <item id="ddcFfeLogLevelItemFatal"
                  label="Fatal"
                  screentip="Logs only Fatal events"
                  supertip="The most critical level, Fatal events demand immediate attention." />
            <item id="ddcFfeLogLevelItemError"
                  label="Error"
                  screentip="Logs only Error and Fatal events"
                  supertip="When functionality is unavailable or expectations broken, an Error event is used." />
            <item id="ddcFfeLogLevelItemWarning"
                  label="Warning"
                  screentip="Logs only Warning and higher events"
                  supertip="When service is degraded, endangered, or may be behaving outside of its expected parameters, Warning level events are used." />
            <item id="ddcFfeLogLevelItemInformation"
                  label="Information"
                  screentip="Logs only Information and higher events"
                  supertip="Information events describe things happening in the system that correspond to its responsibilities and functions. Generally these are the observable actions the system can perform." />
            <item id="ddcFfeLogLevelItemDebug"
                  label="Debug"
                  screentip="Logs only Debug and higher events"
                  supertip="Debug is used for internal system events that are not necessarily observable from the outside, but useful when determining how something happened." />
            <item id="ddcFfeLogLevelItemVerbose"
                  label="Verbose"
                  screentip="Logs all events"
                  supertip="Verbose is the noisiest level, rarely (if ever) enabled for a production app." />
          </dropDown>
          <separator id="sepFfe3"/>
          <button id="btnFeeHomepage"
                  label="Help"
                  size="large"
                  screentip="FFE: Homepage (GitHub)"
                  imageMso="Help"
                  onAction="OpenHelpLink"
                  tag="https://github.com/LelandGrunt/FFE" />
          <menu id="mnuFfeInfo"
                label="Info"
                size="large"
                itemSize="normal"
                screentip="FFE Infomations"
                supertip="FFE Informations."
                imageMso="Info" >
            <button id="btnFfeAbout"
                    label="About"
                    onAction="ShowFfeAbout" />
            <button id="btnFfeCheckUpdate"
                    label="Check for Update"
                    screentip="Check for new FFE version"
                    onAction="CheckUpdate" />
          </menu>
        </group>
      </tab>
    </tabs>
  </ribbon>
</customUI>